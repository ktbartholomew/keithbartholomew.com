/*!
 * jQuery UI Draggable @VERSION
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

(function(c,x){c.widget("ui.draggable",c.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var d=this.options;if(this.helper||d.disabled||c(b.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(b);if(!this.handle)return!1;d.iframeFix&&c(!0===d.iframeFix?"iframe":d.iframeFix).each(function(){c('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(c(this).offset()).appendTo("body")});return!0},_mouseStart:function(b){var d=this.options;this.helper=this._createHelper(b);this._cacheHelperProportions();c.ui.ddmanager&&(c.ui.ddmanager.current=
this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};c.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(b);this.originalPageX=b.pageX;
this.originalPageY=b.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);d.containment&&this._setContainment();if(!1===this._trigger("start",b))return this._clear(),!1;this._cacheHelperProportions();c.ui.ddmanager&&!d.dropBehaviour&&c.ui.ddmanager.prepareOffsets(this,b);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(b,!0);c.ui.ddmanager&&c.ui.ddmanager.dragStart(this,b);return!0},_mouseDrag:function(b,d){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");
if(!d){var a=this._uiHash();if(!1===this._trigger("drag",b,a))return this._mouseUp({}),!1;this.position=a.position}this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px");this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");c.ui.ddmanager&&c.ui.ddmanager.drag(this,b);return!1},_mouseStop:function(b){var d=!1;c.ui.ddmanager&&!this.options.dropBehaviour&&(d=c.ui.ddmanager.drop(this,b));this.dropped&&(d=this.dropped,this.dropped=
!1);for(var a=this.element[0],e=!1;a&&(a=a.parentNode);)a==document&&(e=!0);if(!e&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!d||"valid"==this.options.revert&&d||!0===this.options.revert||c.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var f=this;c(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==f._trigger("stop",b)&&f._clear()})}else!1!==this._trigger("stop",b)&&this._clear();return!1},
_mouseUp:function(b){!0===this.options.iframeFix&&c("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});c.ui.ddmanager&&c.ui.ddmanager.dragStop(this,b);return c.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var d=this.options.handle&&c(this.options.handle,this.element).length?!1:!0;c(this.options.handle,this.element).find("*").andSelf().each(function(){this==
b.target&&(d=!0)});return d},_createHelper:function(b){var d=this.options;b=c.isFunction(d.helper)?c(d.helper.apply(this.element[0],[b])):"clone"==d.helper?this.element.clone().removeAttr("id"):this.element;b.parents("body").length||b.appendTo("parent"==d.appendTo?this.element[0].parentNode:d.appendTo);b[0]==this.element[0]||/(fixed|absolute)/.test(b.css("position"))||b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));c.isArray(b)&&(b={left:+b[0],
top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&c.ui.contains(this.scrollParent[0],
this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&c.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var b=this.element.position();return{top:b.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=["document"==b.containment?0:c(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==b.containment?0:c(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==b.containment?0:c(window).scrollLeft())+c("document"==b.containment?document:
window).width()-this.helperProportions.width-this.margins.left,("document"==b.containment?0:c(window).scrollTop())+(c("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(/^(document|window|parent)$/.test(b.containment)||b.containment.constructor==Array)b.containment.constructor==Array&&(this.containment=b.containment);else{var b=c(b.containment),d=b[0];if(d){b.offset();var a="hidden"!=c(d).css("overflow");this.containment=
[(parseInt(c(d).css("borderLeftWidth"),10)||0)+(parseInt(c(d).css("paddingLeft"),10)||0),(parseInt(c(d).css("borderTopWidth"),10)||0)+(parseInt(c(d).css("paddingTop"),10)||0),(a?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c(d).css("borderLeftWidth"),10)||0)-(parseInt(c(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(a?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c(d).css("borderTopWidth"),10)||0)-(parseInt(c(d).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=b}}},_convertPositionTo:function(b,d){d||(d=this.position);var a="absolute"==b?1:-1,e="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&c.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:d.top+this.offset.relative.top*a+this.offset.parent.top*a-(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?
0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*a),left:d.left+this.offset.relative.left*a+this.offset.parent.left*a-(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*a)}},_generatePosition:function(b){var d=this.options,a="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&c.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,
e=/(html|body)/i.test(a[0].tagName),f=b.pageX,h=b.pageY;if(this.originalPosition){var g;this.containment&&(this.relative_container?(g=this.relative_container.offset(),g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]):g=this.containment,b.pageX-this.offset.click.left<g[0]&&(f=g[0]+this.offset.click.left),b.pageY-this.offset.click.top<g[1]&&(h=g[1]+this.offset.click.top),b.pageX-this.offset.click.left>g[2]&&(f=g[2]+this.offset.click.left),
b.pageY-this.offset.click.top>g[3]&&(h=g[3]+this.offset.click.top));d.grid&&(h=d.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,h=g?h-this.offset.click.top<g[1]||h-this.offset.click.top>g[3]?h-this.offset.click.top<g[1]?h+d.grid[1]:h-d.grid[1]:h:h,f=d.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,f=g?f-this.offset.click.left<g[0]||f-this.offset.click.left>g[2]?f-this.offset.click.left<g[0]?
f+d.grid[0]:f-d.grid[0]:f:f)}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:a.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:a.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]==this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,d,a){a=a||this._uiHash();c.ui.plugin.call(this,b,[d,a]);"drag"==b&&(this.positionAbs=this._convertPositionTo("absolute"));return c.Widget.prototype._trigger.call(this,b,d,a)},plugins:{},_uiHash:function(b){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});c.extend(c.ui.draggable,{version:"@VERSION"});
c.ui.plugin.add("draggable","connectToSortable",{start:function(b,d){var a=c(this).data("draggable"),e=a.options,f=c.extend({},d,{item:a.element});a.sortables=[];c(e.connectToSortable).each(function(){var d=c.data(this,"sortable");d&&!d.options.disabled&&(a.sortables.push({instance:d,shouldRevert:d.options.revert}),d.refreshPositions(),d._trigger("activate",b,f))})},stop:function(b,d){var a=c(this).data("draggable"),e=c.extend({},d,{item:a.element});c.each(a.sortables,function(){this.instance.isOver?
(this.instance.isOver=0,a.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"==a.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,d){var a=c(this).data("draggable"),e=this;c.each(a.sortables,function(f){this.instance.positionAbs=
a.positionAbs;this.instance.helperProportions=a.helperProportions;this.instance.offset.click=a.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=c(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return d.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,
!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=a.offset.click.top,this.instance.offset.click.left=a.offset.click.left,this.instance.offset.parent.left-=a.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=a.offset.parent.top-this.instance.offset.parent.top,a._trigger("toSortable",b),a.dropped=this.instance.element,a.currentItem=a.element,this.instance.fromOutside=a),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&
(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),a._trigger("fromSortable",b),a.dropped=!1)})}});c.ui.plugin.add("draggable","cursor",{start:function(b,d){var a=c("body"),e=c(this).data("draggable").options;
a.css("cursor")&&(e._cursor=a.css("cursor"));a.css("cursor",e.cursor)},stop:function(b,d){var a=c(this).data("draggable").options;a._cursor&&c("body").css("cursor",a._cursor)}});c.ui.plugin.add("draggable","opacity",{start:function(b,d){var a=c(d.helper),e=c(this).data("draggable").options;a.css("opacity")&&(e._opacity=a.css("opacity"));a.css("opacity",e.opacity)},stop:function(b,d){var a=c(this).data("draggable").options;a._opacity&&c(d.helper).css("opacity",a._opacity)}});c.ui.plugin.add("draggable",
"scroll",{start:function(b,d){var a=c(this).data("draggable");a.scrollParent[0]!=document&&"HTML"!=a.scrollParent[0].tagName&&(a.overflowOffset=a.scrollParent.offset())},drag:function(b,d){var a=c(this).data("draggable"),e=a.options,f=!1;a.scrollParent[0]!=document&&"HTML"!=a.scrollParent[0].tagName?(e.axis&&"x"==e.axis||(a.overflowOffset.top+a.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?a.scrollParent[0].scrollTop=f=a.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-a.overflowOffset.top<
e.scrollSensitivity&&(a.scrollParent[0].scrollTop=f=a.scrollParent[0].scrollTop-e.scrollSpeed)),e.axis&&"y"==e.axis||(a.overflowOffset.left+a.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?a.scrollParent[0].scrollLeft=f=a.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-a.overflowOffset.left<e.scrollSensitivity&&(a.scrollParent[0].scrollLeft=f=a.scrollParent[0].scrollLeft-e.scrollSpeed))):(e.axis&&"x"==e.axis||(b.pageY-c(document).scrollTop()<e.scrollSensitivity?f=c(document).scrollTop(c(document).scrollTop()-
e.scrollSpeed):c(window).height()-(b.pageY-c(document).scrollTop())<e.scrollSensitivity&&(f=c(document).scrollTop(c(document).scrollTop()+e.scrollSpeed))),e.axis&&"y"==e.axis||(b.pageX-c(document).scrollLeft()<e.scrollSensitivity?f=c(document).scrollLeft(c(document).scrollLeft()-e.scrollSpeed):c(window).width()-(b.pageX-c(document).scrollLeft())<e.scrollSensitivity&&(f=c(document).scrollLeft(c(document).scrollLeft()+e.scrollSpeed))));!1!==f&&c.ui.ddmanager&&!e.dropBehaviour&&c.ui.ddmanager.prepareOffsets(a,
b)}});c.ui.plugin.add("draggable","snap",{start:function(b,d){var a=c(this).data("draggable"),e=a.options;a.snapElements=[];c(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=c(this),d=b.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:d.top,left:d.left})})},drag:function(b,d){for(var a=c(this).data("draggable"),e=a.options,f=e.snapTolerance,h=d.offset.left,g=h+a.helperProportions.width,q=d.offset.top,
r=q+a.helperProportions.height,k=a.snapElements.length-1;0<=k;k--){var l=a.snapElements[k].left,n=l+a.snapElements[k].width,m=a.snapElements[k].top,p=m+a.snapElements[k].height;if(l-f<h&&h<n+f&&m-f<q&&q<p+f||l-f<h&&h<n+f&&m-f<r&&r<p+f||l-f<g&&g<n+f&&m-f<q&&q<p+f||l-f<g&&g<n+f&&m-f<r&&r<p+f){if("inner"!=e.snapMode){var s=Math.abs(m-r)<=f,t=Math.abs(p-q)<=f,u=Math.abs(l-g)<=f,v=Math.abs(n-h)<=f;s&&(d.position.top=a._convertPositionTo("relative",{top:m-a.helperProportions.height,left:0}).top-a.margins.top);
t&&(d.position.top=a._convertPositionTo("relative",{top:p,left:0}).top-a.margins.top);u&&(d.position.left=a._convertPositionTo("relative",{top:0,left:l-a.helperProportions.width}).left-a.margins.left);v&&(d.position.left=a._convertPositionTo("relative",{top:0,left:n}).left-a.margins.left)}var w=s||t||u||v;"outer"!=e.snapMode&&(s=Math.abs(m-q)<=f,t=Math.abs(p-r)<=f,u=Math.abs(l-h)<=f,v=Math.abs(n-g)<=f,s&&(d.position.top=a._convertPositionTo("relative",{top:m,left:0}).top-a.margins.top),t&&(d.position.top=
a._convertPositionTo("relative",{top:p-a.helperProportions.height,left:0}).top-a.margins.top),u&&(d.position.left=a._convertPositionTo("relative",{top:0,left:l}).left-a.margins.left),v&&(d.position.left=a._convertPositionTo("relative",{top:0,left:n-a.helperProportions.width}).left-a.margins.left));!a.snapElements[k].snapping&&(s||t||u||v||w)&&a.options.snap.snap&&a.options.snap.snap.call(a.element,b,c.extend(a._uiHash(),{snapItem:a.snapElements[k].item}));a.snapElements[k].snapping=s||t||u||v||w}else a.snapElements[k].snapping&&
a.options.snap.release&&a.options.snap.release.call(a.element,b,c.extend(a._uiHash(),{snapItem:a.snapElements[k].item})),a.snapElements[k].snapping=!1}}});c.ui.plugin.add("draggable","stack",{start:function(b,d){var a=c(this).data("draggable").options,a=c.makeArray(c(a.stack)).sort(function(a,b){return(parseInt(c(a).css("zIndex"),10)||0)-(parseInt(c(b).css("zIndex"),10)||0)});if(a.length){var e=parseInt(a[0].style.zIndex)||0;c(a).each(function(a){this.style.zIndex=e+a});this[0].style.zIndex=e+a.length}}});
c.ui.plugin.add("draggable","zIndex",{start:function(b,d){var a=c(d.helper),e=c(this).data("draggable").options;a.css("zIndex")&&(e._zIndex=a.css("zIndex"));a.css("zIndex",e.zIndex)},stop:function(b,d){var a=c(this).data("draggable").options;a._zIndex&&c(d.helper).css("zIndex",a._zIndex)}})})(jQuery);
